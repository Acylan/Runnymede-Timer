<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Exam Timer - Correct Alignment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to mimic the blue time display glow */
        .time-shadow-primary {
            text-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }
        /* Style adjustments to make the time input look consistent on dark mode */
        input[type="time"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
        }
        /* Utility classes from Shadcn/ui context */
        .shadcn-input {
            display: flex;
            width: 100%;
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.25rem 0.5rem;
            font-size: 1rem;
            line-height: 1.5rem;
            --tw-ring-offset-width: 0px;
            --tw-ring-color: transparent;
        }
        .shadcn-label {
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            line-height: 1.25rem;
        }
    </style>
</head>
<body class="bg-slate-900">

    <div id="app" class="min-h-screen bg-gradient-to-br from-slate-900 via-blue-950 to-slate-900 text-white p-4 flex flex-col items-center justify-center relative overflow-hidden">
        
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none overflow-hidden z-0">
            <img 
                src="./assets/Runnymede Logo.png" 
                alt="Exam Logo" 
                class="max-w-[80%] max-h-[80%] object-contain opacity-10 blur-sm"
            />
        </div>

        <div class="relative z-10 w-full max-w-7xl space-y-8">
            <div class="text-center space-y-4">
                <h1 id="header-title" class="text-5xl md:text-7xl font-bold tracking-tight text-white drop-shadow-lg">
                    Exam Timer Setup
                </h1>
                <div id="header-info">
                    <p class="text-blue-200 text-lg">Configure your exam details and schedule</p>
                </div>
            </div>

            <div id="running-state" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl mx-auto">
                    
                    <div class="lg:col-span-2 bg-slate-800/40 backdrop-blur-xl border-2 border-blue-400/30 shadow-2xl overflow-hidden rounded-xl">
                        <div class="flex flex-col items-center justify-center p-12 md:p-16 h-full">
                            <div class="text-lg uppercase tracking-[0.2em] text-blue-300 mb-6 font-semibold flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                                CURRENT TIME
                            </div>
                            <div id="current-system-time-display" class="text-8xl md:text-[10rem] leading-none font-mono font-bold text-white tracking-wider time-shadow-primary">
                                00:00:00
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-1 flex flex-col gap-6">
                        
                        <div class="bg-slate-800/40 backdrop-blur-xl border border-green-500/20 shadow-xl rounded-xl">
                            <div class="flex flex-col items-center justify-center p-6">
                                <div class="text-sm uppercase tracking-widest text-green-400/80 mb-2 font-semibold">Start Time</div>
                                <div id="start-time-display" class="text-5xl font-mono font-bold text-white drop-shadow-md">
                                    09:00
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-800/40 backdrop-blur-xl border border-blue-500/20 shadow-xl rounded-xl">
                            <div class="flex flex-col items-center justify-center p-6">
                                <div class="text-sm uppercase tracking-widest text-blue-400/80 mb-2 font-semibold">End Time</div>
                                <div id="end-time-display" class="text-5xl font-mono font-bold text-white drop-shadow-md">
                                    11:00
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-800/40 backdrop-blur-xl border border-amber-500/20 shadow-xl rounded-xl">
                            <div class="flex flex-col items-center justify-center p-6">
                                <div class="text-sm uppercase tracking-widest text-amber-400/80 mb-2 font-semibold">Extra Time End</div>
                                <div id="extra-end-time-display" class="text-5xl font-mono font-bold text-white drop-shadow-md">
                                    11:30
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-span-full flex justify-center mt-2">
                        <button 
                            onclick="resetExam()"
                            class="text-slate-400 hover:text-white hover:bg-white/5 transition-colors p-3 rounded-lg flex items-center"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M21.1 17.5a9 9 0 1 1-2.2-8.5"/><path d="M21.5 2l-4 4"/></svg>
                            Reset / Configure New Exam
                        </button>
                    </div>
                </div>
            </div>

            <div id="setup-state" class="">
                <div class="bg-slate-800/60 backdrop-blur-xl border border-slate-700 shadow-2xl max-w-4xl mx-auto rounded-xl">
                    <div class="p-8 md:p-10 space-y-8">
                        <div class="space-y-8">
                            <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
                                <div class="md:col-span-8 space-y-2">
                                    <label class="shadcn-label text-blue-200">Exam Name / Subject</label>
                                    <div class="relative">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-3.5 h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20h-5.5"/><path d="M18 6h-8"/><path d="M18 10h-8"/><path d="M12 14h-2"/></svg>
                                        <input 
                                            type="text"
                                            id="exam-name-input"
                                            value="A-Level Maths"
                                            class="shadcn-input pl-9 bg-slate-900/50 border-slate-600 text-white h-11 text-lg focus:border-blue-500 transition-colors"
                                            placeholder="e.g. Mathematics Paper 1"
                                        />
                                    </div>
                                </div>
                                <div class="md:col-span-4 space-y-2">
                                    <label class="shadcn-label text-green-300">Starting Time</label>
                                    <div class="relative">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-3.5 h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                                        <input 
                                            type="time"
                                            id="start-time-input"
                                            value="09:00"
                                            oninput="updateSetupTimes()"
                                            class="shadcn-input pl-9 bg-slate-900/50 border-green-500/30 text-white h-11 font-mono text-lg"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="space-y-2">
                                    <label class="shadcn-label text-blue-200">Center Number</label>
                                    <div class="relative">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-3.5 h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></svg>
                                        <input 
                                            type="text"
                                            id="center-number-input"
                                            value="12345"
                                            class="shadcn-input pl-9 bg-slate-900/50 border-slate-600 text-white h-11"
                                            placeholder="12345"
                                        />
                                    </div>
                                </div>
                                <div class="space-y-2">
                                    <label class="shadcn-label text-blue-200">Paper / Unit Code</label>
                                    <div class="relative">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-3.5 h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                                        <input 
                                            type="text"
                                            id="paper-code-input"
                                            value="9709/12"
                                            class="shadcn-input pl-9 bg-slate-900/50 border-slate-600 text-white h-11"
                                            placeholder="9709/12"
                                        />
                                    </div>
                                </div>
                                <div class="space-y-2">
                                    <label class="shadcn-label text-blue-300">Duration (Minutes)</label>
                                    <div class="flex items-center gap-3 bg-slate-900/50 border border-blue-500/30 rounded-md p-1 pr-3 h-11">
                                        <input 
                                            type="number"
                                            id="duration-input"
                                            value="120"
                                            oninput="updateSetupTimes()"
                                            class="bg-transparent border-0 text-white h-full w-20 text-center font-mono focus-visible:ring-0 focus-visible:ring-offset-0 text-lg shadcn-input"
                                            placeholder="60"
                                        />
                                        <div class="h-6 w-px bg-slate-700 mx-1"></div>
                                        <div class="flex flex-col text-xs leading-tight whitespace-nowrap">
                                            <span class="text-blue-200">End: <span id="setup-end-time" class="font-mono font-bold text-white">11:00</span></span>
                                            <span class="text-amber-200">Extra: <span id="setup-extra-end-time" class="font-mono font-bold text-white">11:30</span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="pt-4">
                            <button 
                                onclick="startExam()"
                                type="button"
                                class="w-full h-14 text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white shadow-lg shadow-blue-500/25 transition-all duration-300 transform hover:scale-[1.01] rounded-lg flex items-center justify-center"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mr-2 fill-current" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                                START EXAM DISPLAY
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            </div>
    </div>

    <script>
        let systemClockInterval;
        const appContainer = document.getElementById('app');

        // --- Utility Functions ---

        // Function to calculate a time string based on start time and minutes added
        function calculateTime(start, minutesToAdd) {
            if (!start || !minutesToAdd) return '--:--';
            
            const [hours, minutes] = start.split(':').map(Number);
            const date = new Date();
            // Using a fixed date ensures arithmetic is correct, but only HH:MM is displayed
            date.setHours(hours, minutes, 0, 0); 
            date.setMinutes(date.getMinutes() + Math.round(Number(minutesToAdd)));

            // Format as HH:MM
            return date.toLocaleTimeString('en-GB', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
        }
        
        // --- Setup Logic ---

        function updateSetupTimes() {
            const startTime = document.getElementById('start-time-input').value;
            const duration = document.getElementById('duration-input').value;

            // Ensure we have valid inputs before calculating
            if (!startTime || !duration) return;

            const endTime = calculateTime(startTime, duration);
            const extraDuration = Math.round(Number(duration) * 1.25);
            const extraEndTime = calculateTime(startTime, extraDuration);

            document.getElementById('setup-end-time').textContent = endTime;
            document.getElementById('setup-extra-end-time').textContent = extraEndTime;
        }

        // --- Runtime Logic (Clock update) ---

        function updateSystemClock() {
            const now = new Date();
            // Format: HH:MM:SS
            const timeString = now.toLocaleTimeString('en-GB', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            const displayElement = document.getElementById('current-system-time-display');
            if (displayElement) {
                displayElement.textContent = timeString;
            }
        }
        
        // --- State Controllers ---

        function setAlignment(state) {
            if (state === 'running') {
                // RUNNING: Align to top, add top padding
                appContainer.classList.remove('justify-center');
                appContainer.classList.add('justify-start', 'pt-8');
            } else {
                // SETUP: Align to center, remove top padding
                appContainer.classList.remove('justify-start', 'pt-16');
                appContainer.classList.add('justify-center');
            }
        }

        function startExam() {
            const examName = document.getElementById('exam-name-input').value || 'Exam In Progress';
            const startTimeValue = document.getElementById('start-time-input').value;
            const durationValue = document.getElementById('duration-input').value;
            const centerNumber = document.getElementById('center-number-input').value;
            const paperCode = document.getElementById('paper-code-input').value;
            
            // 1. Calculate and Populate Display Times
            const endTime = calculateTime(startTimeValue, durationValue);
            const extraDuration = Math.round(Number(durationValue) * 1.25);
            const extraEndTime = calculateTime(startTimeValue, extraDuration);

            document.getElementById('start-time-display').textContent = startTimeValue;
            document.getElementById('end-time-display').textContent = endTime;
            document.getElementById('extra-end-time-display').textContent = extraEndTime;

            // 2. Update Header Info
            document.getElementById('header-title').textContent = examName;
            document.getElementById('header-info').innerHTML = `
                <div class="flex items-center justify-center gap-8 text-2xl text-blue-100 bg-white/5 inline-flex px-8 py-3 rounded-full backdrop-blur-sm border border-white/10 whitespace-nowrap">
                    ${centerNumber ? `
                    <div class="flex items-center gap-3">
                        <span class="uppercase tracking-widest text-xs font-semibold opacity-60">Center No</span>
                        <span class="font-mono font-bold tracking-wider">${centerNumber}</span>
                    </div>` : ''}
                    ${centerNumber && paperCode ? `<div class="w-px bg-white/20 h-8 self-center"></div>` : ''}
                    ${paperCode ? `
                    <div class="flex items-center gap-3">
                        <span class="uppercase tracking-widest text-xs font-semibold opacity-60">Paper Code</span>
                        <span class="font-mono font-bold tracking-wider">${paperCode}</span>
                    </div>` : ''}
                </div>
            `;
            
            // 3. Switch View and Alignment
            setAlignment('running');
            document.getElementById('setup-state').classList.add('hidden');
            document.getElementById('running-state').classList.remove('hidden');
        }

        function resetExam() {
            // 1. Switch View and Alignment
            setAlignment('setup');
            document.getElementById('running-state').classList.add('hidden');
            document.getElementById('setup-state').classList.remove('hidden');

            // 2. Reset Header Info
            document.getElementById('header-title').textContent = 'Exam Timer Setup';
            document.getElementById('header-info').innerHTML = '<p class="text-blue-200 text-lg">Configure your exam details and schedule</p>';
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Start the system clock immediately and keep it running
            updateSystemClock();
            systemClockInterval = setInterval(updateSystemClock, 1000);
            
            // Update the calculated times in the setup form on load
            updateSetupTimes();

            // Ensure correct initial alignment (Setup is centered)
            setAlignment('setup');
        });
    </script>
</body>
</html>
